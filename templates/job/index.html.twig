{% extends 'base.html.twig' %}

{% block title %}Projects{% endblock %}

{% block body %}

    <section class="dashboard section">
        <!-- Container Start -->
        <div class="container">
            <!-- Row Start -->
            <div class="row">


                <div class="col-lg-12">
                    <!-- Search Widget -->
                    <div class="widget search p-0">
                        <div class="input-group">
                            <form action="{{ path('job_index') }}" id="search-form" class="form-inline" method="get">

                                <input type="text"
                                       name="q"
                                       id="search_title"
                                       class="form-control"
                                       placeholder="{{ 'Search a project'|trans }}..."
                                       value="{{ app.request.get('q') }}"
                                       autocomplete="off"
                                       autofocus
                                       data-no-results-message="{{ 'post.search_no_results'|trans }}" >


                            </form>
                        </div>
                    </div>

                </div>

                <div class="col-lg-12">
                    {{'Found Projects'|trans}}: <span id="show_count">{{ jobs.getTotalItemCount }}</span>
                </div>


                <div class="col-md-10 offset-md-1 col-lg-8 offset-lg-0">
                    <!-- Recently Favorited -->
                    <div class="widget dashboard-container my-adslist">

                        <table class="table table-responsive job-dashboard-table">

                            <tbody>

                            {{ include('/job/search.ajax.twig') }}


                            </tbody>
                        </table>
                        <!-- Pagination -->
                         {{ knp_pagination_render(jobs) }}

                    </div>
                </div>



                <div class="col-md-10 offset-md-1 col-lg-4 offset-lg-0">
                    <div class="sidebar">

                        <!--Filter Widget -->
                        <div class="widget category">
                            <!-- Widget Header -->
                            <h5 class="widget-header">{{'Categories'|trans}}</h5>
                            <div class="parent-check">
                                <input type="checkbox"><label>Level 1</label>
                                <div class="child-check">
                                    <input type="checkbox"><label>Level 1.1</label>
                                    <div class="child-check">
                                        <input type="checkbox"><label>Level 1.1.1</label>
                                    </div>
                                </div>
                                <div class="child-check">
                                    <input type="checkbox"><label>Level 1.2</label>
                                </div>
                            </div>
                            <div class="parent-check">
                                <input type="checkbox"><label>Level 2</label>
                                <div class="child-check">
                                    <input type="checkbox"><label>Level 2.1</label>
                                </div>
                            </div>
                            <ul class="category-list">
                                <li><a href="">Appearel <span class="float-right">(2)</span></a></li>
                                <li><a href="">Accesories <span class="float-right">(5)</span></a></li>
                                <li><a href="">Business<span class="float-right">(7)</span></a></li>
                                <li><a href="">Entertaiment<span class="float-right">(3)</span></a></li>
                                <li><a href="">Education<span class="float-right">(9)</span></a></li>
                            </ul>
                        </div>


                    </div>
                </div>


            </div>
            <!-- Row End -->
        </div>
        <!-- Container End -->
    </section>


{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>

        jQuery(document).ready(function($){

            $('#search-form').keyup(function(e){


                var input=$('#search_title').val();
                if (input.length>0) {
                    var insert_results= $('.job-dashboard-table tbody');
                    var show_count= $('#show_count');
                    insert_results.html("");
                    show_count.html("");
                    var url = '{{ path("job_search", {'search': 'input'}) }}';
                    url = url.replace("input", input);
                    $.get(url, function (data, textStatus, xhr) {
                        data.count===0 ?show_count.html(0) : show_count.html(data.count);

                        if ("object" !== typeof data || null === data) {
                            console.log("Unexpected response from server.");
                            return;
                        }

                        if (!data.hasOwnProperty("html") || typeof data.html != "string" || (data.html = data.html.trim()).length < 1) {
                            return;
                        }

                        insert_results.html(data.html);


                    }).fail(function (xhr, textStatus, errorThrown) {

                        var error = "Unknown error occurred.";
                        if ("object" === typeof xhr && null !== xhr && xhr.hasOwnProperty("responseJSON") && "object" === typeof xhr.responseJSON && xhr.responseJSON.hasOwnProperty("error") && "string" === typeof xhr.responseJSON.error && xhr.responseJSON.error.trim().length >= 1) {
                            error = xhr.responseJSON.error.trim();
                        } else if ("string" === typeof errorThrown && errorThrown.trim().length >= 1) {
                            error = errorThrown.trim();
                        }

                        console.log(error);

                    });
                }

            });

        });
     </script>


{% endblock %}

